local Rayfield = loadstring(game:HttpGet('https://raw.githubusercontent.com/hominhtrieu56-spec/TrieuHentaiz/refs/heads/main/TrieuHentaiz'))()

local Window = Rayfield:CreateWindow({
   Name = "TrieuDepZai",
   LoadingTitle = "Cùng Tận hưởng với TrieuDepzai",
   LoadingSubtitle = "Loaded Successfully",
   ConfigurationSaving = {
      Enabled = true,
      FolderName = "TrieuHentaiz",
      FileName = "TrieuConfig"
   },
   Discord = {
      Enabled = false,
      RememberJoins = true
   },
   KeySystem = false,
})

-- Load ZAP module
local ZAP = require(game:GetService("ReplicatedStorage").Client.ClientRemotes)

-- Services
local Players = game:GetService("Players")
local RunService = game:GetService("RunService")

-- ESP Variables
local ESPFolder = Instance.new("Folder")
ESPFolder.Name = "ESP"
ESPFolder.Parent = game.CoreGui

-- ESP Settings
local ESPConfig = {
    MonsterESP = false,
    ItemESP = false,
    ShowNames = true,
    ShowDistance = true,
    ShowHighlight = true
}

-- Combat Tab
local CombatTab = Window:CreateTab("Combat", 4483362458)

local CombatSection = CombatTab:CreateSection("Kill Aura")

local KillAuraToggle = CombatTab:CreateToggle({
   Name = "Kill Aura",
   CurrentValue = false,
   Flag = "KillAuraToggle",
   Callback = function(Value)
      _G.KillAuraEnabled = Value
   end,
})

local AuraDistanceSlider = CombatTab:CreateSlider({
   Name = "Kill Aura Distance",
   Range = {10, 50},
   Increment = 5,
   Suffix = "Studs",
   CurrentValue = 25,
   Flag = "AuraDistance",
   Callback = function(Value)
      _G.AuraDistance = Value
   end,
})

local KillAllButton = CombatTab:CreateButton({
   Name = "Kill All Zombies",
   Callback = function()
      local character = Players.LocalPlayer.Character
      if character and character:FindFirstChild("HumanoidRootPart") then
          for _, monster in pairs(workspace.Monsters:GetChildren()) do
              if monster:FindFirstChild("HumanoidRootPart") then
                  ZAP.meleeAttack.fire({
                      monsters = {monster},
                      civilians = {},
                      activeSlot = _G.WeaponSlot or 2
                  })
                  task.wait(0.1)
              end
          end
      end
   end,
})

-- Items Tab
local ItemsTab = Window:CreateTab("Items", 4483362458)

local ItemsSection = ItemsTab:CreateSection("Item Management")

local BringBodiesButton = ItemsTab:CreateButton({
   Name = "Bring Bodies",
   Callback = function()
      local character = Players.LocalPlayer.Character
      if character and character.PrimaryPart then
          for _, v in pairs(workspace.Interactables:GetChildren()) do 
              if v:IsA("Model") and v:FindFirstChild("HumanoidRootPart") and not v:FindFirstChild("ProductPriceTag") then
                  v.PrimaryPart.CFrame = character.PrimaryPart.CFrame
                  task.wait(0.05)
              end
          end
      end
   end,
})

local BringAllItemsButton = ItemsTab:CreateButton({
   Name = "Bring All Items",
   Callback = function()
      local character = Players.LocalPlayer.Character
      if character and character.PrimaryPart then
          for _, v in pairs(workspace.Interactables:GetChildren()) do 
              if v:IsA("Model") and not v:FindFirstChild("ProductPriceTag") and v.PrimaryPart then
                  v.PrimaryPart.CFrame = character.PrimaryPart.CFrame
                  task.wait(0.05)
              end
          end
      end
   end,
})

-- Player Tab
local PlayerTab = Window:CreateTab("Player", 4483362458)

local PlayerSection = PlayerTab:CreateSection("Character Settings")

local WalkSpeedSlider = PlayerTab:CreateSlider({
   Name = "WalkSpeed",
   Range = {16, 200},
   Increment = 5,
   Suffix = "Speed",
   CurrentValue = 16,
   Flag = "WalkSpeed",
   Callback = function(Value)
      _G.WalkSpeed = Value
      local character = Players.LocalPlayer.Character
      if character and character:FindFirstChild("Humanoid") then
          character.Humanoid.WalkSpeed = Value
      end
   end,
})

local JumpPowerSlider = PlayerTab:CreateSlider({
   Name = "JumpPower",
   Range = {50, 200},
   Increment = 10,
   Suffix = "Power",
   CurrentValue = 50,
   Flag = "JumpPower",
   Callback = function(Value)
      _G.JumpPower = Value
      local character = Players.LocalPlayer.Character
      if character and character:FindFirstChild("Humanoid") then
          character.Humanoid.JumpPower = Value
      end
   end,
})

local SlotDropdown = PlayerTab:CreateDropdown({
   Name = "Weapon Slot",
   Options = {"1", "2", "3", "4", "5", "6", "7", "8", "9", "10"},
   CurrentOption = "2",
   Flag = "WeaponSlot",
   Callback = function(Option)
      _G.WeaponSlot = tonumber(Option)
   end,
})

-- ESP Tab
local ESPTab = Window:CreateTab("ESP", 4483362458)

local ESPSection = ESPTab:CreateSection("ESP Types")

local MonsterESPToggle = ESPTab:CreateToggle({
   Name = "Monster ESP",
   CurrentValue = false,
   Flag = "MonsterESP",
   Callback = function(Value)
      ESPConfig.MonsterESP = Value
      UpdateESP()
   end,
})

local ItemESPToggle = ESPTab:CreateToggle({
   Name = "Item ESP",
   CurrentValue = false,
   Flag = "ItemESP",
   Callback = function(Value)
      ESPConfig.ItemESP = Value
      UpdateESP()
   end,
})

local ESPSettingsSection = ESPTab:CreateSection("ESP Settings")

local ShowNamesToggle = ESPTab:CreateToggle({
   Name = "Show Names",
   CurrentValue = true,
   Flag = "ShowNames",
   Callback = function(Value)
      ESPConfig.ShowNames = Value
      UpdateESP()
   end,
})

local ShowDistanceToggle = ESPTab:CreateToggle({
   Name = "Show Distance",
   CurrentValue = true,
   Flag = "ShowDistance",
   Callback = function(Value)
      ESPConfig.ShowDistance = Value
      UpdateESP()
   end,
})

local ShowHighlightToggle = ESPTab:CreateToggle({
   Name = "Show Highlight",
   CurrentValue = true,
   Flag = "ShowHighlight",
   Callback = function(Value)
      ESPConfig.ShowHighlight = Value
      UpdateESP()
   end,
})

-- ESP Functions
function CreateESP(part, color, name, distance)
    local espGroup = {}
    
    -- Billboard GUI for text
    if ESPConfig.ShowNames or ESPConfig.ShowDistance then
        local billboard = Instance.new("BillboardGui")
        billboard.Name = name .. "_Billboard"
        billboard.Adornee = part
        billboard.Size = UDim2.new(0, 200, 0, 50)
        billboard.StudsOffset = Vector3.new(0, 3, 0)
        billboard.AlwaysOnTop = true
        billboard.Parent = ESPFolder
        
        local textLabel = Instance.new("TextLabel")
        textLabel.Size = UDim2.new(1, 0, 1, 0)
        textLabel.BackgroundTransparency = 1
        textLabel.Text = ""
        
        if ESPConfig.ShowNames and ESPConfig.ShowDistance then
            textLabel.Text = name .. "\n" .. math.floor(distance) .. " studs"
        elseif ESPConfig.ShowNames then
            textLabel.Text = name
        elseif ESPConfig.ShowDistance then
            textLabel.Text = math.floor(distance) .. " studs"
        end
        
        textLabel.TextColor3 = color
        textLabel.TextSize = 14
        textLabel.Font = Enum.Font.GothamBold
        textLabel.TextStrokeTransparency = 0
        textLabel.TextStrokeColor3 = Color3.new(0, 0, 0)
        textLabel.Parent = billboard
        
        table.insert(espGroup, billboard)
    end
    
    -- Highlight
    if ESPConfig.ShowHighlight then
        local highlight = Instance.new("Highlight")
        highlight.Name = name .. "_Highlight"
        highlight.Adornee = part
        highlight.FillColor = color
        highlight.OutlineColor = Color3.new(1, 1, 1)
        highlight.FillTransparency = 0.3
        highlight.OutlineTransparency = 0
        highlight.DepthMode = Enum.HighlightDepthMode.AlwaysOnTop
        highlight.Parent = ESPFolder
        table.insert(espGroup, highlight)
    end
    
    return espGroup
end

function ClearESP()
    for _, child in pairs(ESPFolder:GetChildren()) do
        child:Destroy()
    end
end

function UpdateESP()
    ClearESP()
    
    local character = Players.LocalPlayer.Character
    if not character or not character:FindFirstChild("HumanoidRootPart") then return end
    local playerRoot = character.HumanoidRootPart
    
    -- Monster ESP
    if ESPConfig.MonsterESP then
        for _, monster in pairs(workspace.Monsters:GetChildren()) do
            if monster:IsA("Model") then
                -- Try to find any valid part for highlighting
                local targetPart = monster:FindFirstChild("HumanoidRootPart") or monster:FindFirstChild("Head") or monster.PrimaryPart
                if targetPart then
                    local distance = (playerRoot.Position - targetPart.Position).Magnitude
                    CreateESP(targetPart, Color3.fromRGB(255, 50, 50), "Monster: " .. monster.Name, distance)
                end
            end
        end
    end
    
    -- Item ESP (Bodies and Items)
    if ESPConfig.ItemESP then
        for _, item in pairs(workspace.Interactables:GetChildren()) do
            if item:IsA("Model") then
                -- Check if it's a body (has HumanoidRootPart) or regular item (no price tag)
                local isBody = item:FindFirstChild("HumanoidRootPart")
                local isItem = not item:FindFirstChild("ProductPriceTag")
                
                if isBody or isItem then
                    local targetPart = item:FindFirstChild("HumanoidRootPart") or item.PrimaryPart
                    if targetPart then
                        local distance = (playerRoot.Position - targetPart.Position).Magnitude
                        local espName = isBody and "Body: " .. item.Name or "Item: " .. item.Name
                        local espColor = isBody and Color3.fromRGB(255, 165, 0) or Color3.fromRGB(50, 255, 50)
                        CreateESP(targetPart, espColor, espName, distance)
                    end
                end
            end
        end
    end
end

-- Info Tab
local InfoTab = Window:CreateTab("Info", 4483362458)

local InfoSection = InfoTab:CreateSection("Information")

local InfoParagraph = InfoTab:CreateParagraph({
   Title = "Bake or Die Script", 
   Content = "â€¢ Kill Aura with adjustable distance\nâ€¢ Kill All Zombies button\nâ€¢ Bring Bodies & Items\nâ€¢ WalkSpeed & JumpPower sliders\nâ€¢ Monster & Item ESP (can be both on)\nâ€¢ ESP Settings: Names, Distance, Highlight\nâ€¢ Weapon slot selection"
})

-- Kill Aura Loop
task.spawn(function()
    while true do
        task.wait()
        if _G.KillAuraEnabled then
            local character = Players.LocalPlayer.Character
            if character and character:FindFirstChild("HumanoidRootPart") then
                local root = character.HumanoidRootPart
                local slot = _G.WeaponSlot or 2
                local distance = _G.AuraDistance or 25
                
                for _, monster in pairs(workspace.Monsters:GetChildren()) do
                    if monster:FindFirstChild("HumanoidRootPart") then
                        local monsterDistance = (root.Position - monster.HumanoidRootPart.Position).Magnitude
                        if monsterDistance < distance then
                            ZAP.meleeAttack.fire({
                                monsters = {monster},
                                civilians = {},
                                activeSlot = slot
                            })
                            break
                        end
                    end
                end
            end
        end
    end
end)

-- Character Stats Loop
task.spawn(function()
    while true do
        task.wait(1)
        local character = Players.LocalPlayer.Character
        if character and character:FindFirstChild("Humanoid") then
            if _G.WalkSpeed then
                character.Humanoid.WalkSpeed = _G.WalkSpeed
            end
            if _G.JumpPower then
                character.Humanoid.JumpPower = _G.JumpPower
            end
        end
    end
end)

-- ESP Update Loop
task.spawn(function()
    while true do
        task.wait(0.5)
        if ESPConfig.MonsterESP or ESPConfig.ItemESP then
            UpdateESP()
        else
            ClearESP()
        end
    end
end)

-- Notification
Rayfield:Notify({
   Title = "Trieu or Die Script Loaded",
   Content = "All features are now available!",
   Duration = 5,
   Image = 4483362458,
   Actions = {
      Ignore = {
         Name = "Okay!",
         Callback = function()
         print("Trieu or Die Script is ready!")
      end
   },
},
})
